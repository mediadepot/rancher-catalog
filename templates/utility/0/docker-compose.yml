lb:
  image: rancher/load-balancer-service
  ports:
  # Listen on public port 80 and direct traffic to private port 80 of the service
  - 50001:80
  # Listen on public port 82 and by default forward traffic to private port 81 using HTTP
  - 82:81
  # Listen on public port 9999 using TCP and not HTTP
  - 9999/tcp
  # links:
  # Target services in the same stack will be listed as a link
  #  - web1:web1a
  #  - web2:web2a
  external_links:
  # Target services in a different stack will be listed as an external link
  - guacamole/guacweb:guacweb
  - couchpotato/couchpotato:couchpotato
  labels:
    # Put load balancer containers on hosts with label lb=true
    # io.rancher.scheduler.affinity:host_label: lb=true
    # Requests to http://app.example.com/foo:80 should be routed to web1 over port 8000
    io.rancher.loadbalancer.target.couchpotato: couchpotato.depot.local:80=8081
    # Requests to http://app.example.com/foo should be routed to web2 over port 8000 
    # and http://app.example.com/foo/bar over port 8001
    io.rancher.loadbalancer.target.guacweb: guacweb.depot.local:80=8080
